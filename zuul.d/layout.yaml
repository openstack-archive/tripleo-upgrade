---
- project:
    templates:
      - check-requirements
      - openstack-tox-molecule
    check:
      jobs:
        - tripleo-ci-centos-7-scenario000-multinode-oooq-container-updates:
            dependencies:
              - tripleo-upgrade-centos-7-molecule
        - tripleo-ci-centos-7-scenario000-multinode-oooq-container-upgrades:
            dependencies:
              - tripleo-upgrade-centos-7-molecule
        - tripleo-ci-centos-7-containerized-undercloud-upgrades:
            dependencies:
              - tripleo-upgrade-centos-7-molecule
        - tripleo-ci-centos-7-standalone-upgrade:
            voting: false
            dependencies:
              - tripleo-upgrade-centos-7-molecule
            files:
              - ^ci-scripts\/.*$
              - ^defaults\/.*$
              - ^files\/.*$
              - ^meta\/.*$
              - ^tasks\/.*$
              - ^templates\/.*$
              - ^zuul.d\/.*$
        - tripleo-ci-centos-7-standalone-upgrade-train:
            voting: true
            dependencies:
              - tripleo-upgrade-centos-7-molecule
            files:
              - ^ci-scripts\/.*$
              - ^defaults\/.*$
              - ^files\/.*$
              - ^meta\/.*$
              - ^tasks\/.*$
              - ^templates\/.*$
              - ^zuul.d\/.*$
        - tripleo-ci-centos-7-standalone-upgrade-stein:
            dependencies:
              - tripleo-upgrade-centos-7-molecule
        - openstack-tox-linters
        - tripleo-tox-molecule
        - tripleo-upgrade-centos-7-molecule:
            dependencies:
              - tripleo-tox-molecule
    gate:
      queue: tripleo
      jobs:
        - tripleo-ci-centos-7-scenario000-multinode-oooq-container-updates:
            dependencies:
              - tripleo-upgrade-centos-7-molecule
        - tripleo-ci-centos-7-standalone-upgrade-stein:
            dependencies:
              - tripleo-upgrade-centos-7-molecule
        - openstack-tox-linters
        - tripleo-upgrade-centos-7-molecule
        - tripleo-ci-centos-7-standalone-upgrade-train:
            voting: true
            dependencies:
              - tripleo-upgrade-centos-7-molecule
            files:
              - ^ci-scripts\/.*$
              - ^defaults\/.*$
              - ^files\/.*$
              - ^meta\/.*$
              - ^tasks\/.*$
              - ^templates\/.*$
    post:
      jobs:
        - publish-openstack-python-branch-tarball

- job:
    description: Base tripleo-upgrade job
    name: tripleo-upgrade-centos-7-base
    nodeset: centos-7
    parent: base
    success-url: "reports.html"
    failure-url: "reports.html"
    pre-run:
      - zuul.d/playbooks/prepare-test-host.yml
      - zuul.d/playbooks/pre.yml
    run:
      - zuul.d/playbooks/run.yml
    timeout: 1800
    voting: true

- job:
    files:
      - ^.*
    name: tripleo-upgrade-centos-7-molecule
    parent: tripleo-upgrade-centos-7-base
